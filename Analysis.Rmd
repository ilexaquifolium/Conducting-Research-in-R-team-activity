---
title: "Analysis"
author: "Holly W, Charlie C, Manal P"
date: "2025-12-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## import data

and make columns uniform

```{r}
library(readxl)
a = read_excel("A.xlsx")
b = read_excel("B.xlsx")
p = read_excel("P.xlsx")
se = read_excel("SouthEast.xlsx")
d = read.csv("data_entry.csv")
colnames(se) = c("Age","PH","MH","Smoker","Belief","SES5","Gender","Region","ID")
se$ID = NULL

colnames(d) = c("Name","Age","Gender","Belief","PH","MH")
d$Name = NULL
d$Smoker = d$Region = d$SES5 = NA

```

## Merge

```{r}
datasets <- list(a,b,p)
abp = Reduce(function(x,y) rbind(x,y,all=TRUE), datasets)
abp_se = rbind(abp,se)
alldata = rbind(abp_se,d)
```

## Change belief to binary 

```{r}
library(dplyr)
binarycols = c("Belief")
alldata <-  alldata %>%
  mutate(across(
    all_of(binarycols),
    ~ case_when(
      . == "Y" ~ 1,
      . == "N" ~ 0,
      . == "U" ~ NA_real_,
      TRUE ~ NA_real_     
    )
  ))
```
# Coding smoker variable
alldata$Smoker <- ifelse(alldata$Smoker == "N", 0, 
                      ifelse(alldata$Smoker == "Current", 1,
                       ifelse(alldata$Smoker == "Y", 2, alldata$Smoker)))

# Coding SES5 variable
alldata$SES5 <- ifelse(alldata$SES5 == "L1", 1,
                         ifelse(alldata$SES5 == "L2", 2,
                                ifelse(alldata$SES5 == "L3", 3,
                                       ifelse(alldata$SES5 == "L4", 4,
                                              ifelse(alldata$SES5 == "L5", 5,alldata$SES5)))))

# Coding PH variable
alldata$PH <-  ifelse(alldata$PH == "Yes", "Y", alldata$PH)
alldata$PH <-  ifelse(alldata$PH == "No", "N", alldata$PH)

alldata$PH <- ifelse(alldata$PH == "N", 0,
                       ifelse(alldata$PH == "Y", 1, alldata$PH))

# Make variables factors
alldata$PH <- factor(alldata$PH)
alldata$Smoker <- factor(alldata$Smoker)
alldata$SES5 <- factor(alldata$SES5)
## Model 

```{r}
model1 <- glm(
  Belief ~ Age + Gender + MH + PH + Smoker + SES5 + Region,
  data = alldata,
  family = binomial
)
```